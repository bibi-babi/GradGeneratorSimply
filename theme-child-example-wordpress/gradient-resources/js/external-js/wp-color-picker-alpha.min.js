/**!
 * wp-color-picker-alpha
 *
 * Overwrite Automattic Iris for enabled Alpha Channel in wpColorPicker
 * Only run in input and is defined data alpha in true
 *
 * Version: 1.2.2
 * https://github.com/23r9i0/wp-color-picker-alpha
 * Copyright (c) 2015 Sergio P.A. (23r9i0).
 * Licensed under the GPLv2 license.
 */

!function(h){var f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAAHnlligAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHJJREFUeNpi+P///4EDBxiAGMgCCCAGFB5AADGCRBgYDh48CCRZIJS9vT2QBAggFBkmBiSAogxFBiCAoHogAKIKAlBUYTELAiAmEtABEECk20G6BOmuIl0CIMBQ/IEMkO0myiSSraaaBhZcbkUOs0HuBwDplz5uFJ3Z4gAAAABJRU5ErkJggg==",d='<a tabindex="0" class="wp-color-result" />',c='<div class="wp-picker-holder" />',g='<div class="wp-picker-container" />',b='<input type="button" class="button button-small hidden" />';Color.fn.toString=function(){if(this._alpha<1){return this.toCSS("rgba",this._alpha).replace(/\s+/g,"")}var a=parseInt(this._color,10).toString(16);return this.error?"":(a.length<6&&(a=("00000"+a).substr(-6)),"#"+a)},h.widget("wp.wpColorPicker",h.wp.wpColorPicker,{_create:function(){if(h.support.iris){var a=this,e=a.element;h.extend(a.options,e.data()),a.close=h.proxy(a.close,a),a.initialValue=e.val(),e.addClass("wp-color-picker").hide().wrap(g),a.wrap=e.parent(),a.toggler=h(d).insertBefore(e).css({backgroundColor:a.initialValue}).attr("title",wpColorPickerL10n.pick).attr("data-current",wpColorPickerL10n.current),a.pickerContainer=h(c).insertAfter(e),a.button=h(b),a.options.defaultColor?a.button.addClass("wp-picker-default").val(wpColorPickerL10n.defaultString):a.button.addClass("wp-picker-clear").val(wpColorPickerL10n.clear),e.wrap('<span class="wp-picker-input-wrap" />').after(a.button),e.iris({target:a.pickerContainer,hide:a.options.hide,width:a.options.width,mode:a.options.mode,palettes:a.options.palettes,change:function(k,j){a.options.alpha?(a.toggler.css({"background-image":"url("+f+")"}).html("<span />"),a.toggler.find("span").css({width:"100%",height:"100%",position:"absolute",top:0,left:0,"border-top-left-radius":"3px","border-bottom-left-radius":"3px",background:j.color.toString()})):a.toggler.css({backgroundColor:j.color.toString()}),h.isFunction(a.options.change)&&a.options.change.call(this,k,j)}}),e.val(a.initialValue),a._addListeners(),a.options.hide||a.toggler.click()}},_addListeners:function(){var a=this;a.wrap.on("click.wpcolorpicker",function(e){e.stopPropagation()}),a.toggler.on("click",function(){a.toggler.hasClass("wp-picker-open")?a.close():a.open()}),a.element.on("change",function(e){(""===h(this).val()||a.element.hasClass("iris-error"))&&(a.options.alpha?(a.toggler.removeAttr("style"),a.toggler.find("span").css("backgroundColor","")):a.toggler.css("backgroundColor",""),h.isFunction(a.options.clear)&&a.options.clear.call(this,e))}),a.toggler.on("keyup",function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),a.toggler.trigger("click").next().focus())}),a.button.on("click",function(e){h(this).hasClass("wp-picker-clear")?(a.element.val(""),a.options.alpha?(a.toggler.removeAttr("style"),a.toggler.find("span").css("backgroundColor","")):a.toggler.css("backgroundColor",""),h.isFunction(a.options.clear)&&a.options.clear.call(this,e)):h(this).hasClass("wp-picker-default")&&a.element.val(a.options.defaultColor).change()})}}),h.widget("a8c.iris",h.a8c.iris,{_create:function(){if(this._super(),this.options.alpha=this.element.data("alpha")||!1,this.element.is(":input")||(this.options.alpha=!1),"undefined"!=typeof this.options.alpha&&this.options.alpha){var u=this,p=u.element,m='<div class="iris-strip iris-slider iris-alpha-slider"><div class="iris-slider-offset iris-slider-offset-alpha"></div></div>',v=h(m).appendTo(u.picker.find(".iris-picker-inner")),j=v.find(".iris-slider-offset-alpha"),t={aContainer:v,aSlider:j};"undefined"!=typeof p.data("custom-width")?u.options.customWidth=parseInt(p.data("custom-width"))||0:u.options.customWidth=100,u.options.defaultWidth=p.width(),(u._color._alpha<1||-1!=u._color.toString().indexOf("rgb"))&&p.width(parseInt(u.options.defaultWidth+u.options.customWidth)),h.each(t,function(e,a){u.controls[e]=a}),u.controls.square.css({"margin-right":"0"});var w=u.picker.width()-u.controls.square.width()-20,q=w/6,k=w/2-q;h.each(["aContainer","strip"],function(e,a){u.controls[a].width(k).css({"margin-left":q+"px"})}),u._initControls(),u._change()}},_initControls:function(){if(this._super(),this.options.alpha){var e=this,a=e.controls;a.aSlider.slider({orientation:"vertical",min:0,max:100,step:1,value:parseInt(100*e._color._alpha),slide:function(k,j){e._color._alpha=parseFloat(j.value/100),e._change.apply(e,arguments)}})}},_change:function(){this._super();var y=this,o=y.element;if(this.options.alpha){var m=y.controls,w=parseInt(100*y._color._alpha),j=y._color.toRgb(),u=["rgb("+j.r+","+j.g+","+j.b+") 0%","rgba("+j.r+","+j.g+","+j.b+", 0) 100%"],x=y.options.defaultWidth,q=y.options.customWidth,k=y.picker.closest(".wp-picker-container").find(".wp-color-result");m.aContainer.css({background:"linear-gradient(to bottom, "+u.join(", ")+"), url("+f+")"}),k.hasClass("wp-picker-open")&&(m.aSlider.slider("value",w),y._color._alpha<1?(m.strip.attr("style",m.strip.attr("style").replace(/rgba\(([0-9]+,)(\s+)?([0-9]+,)(\s+)?([0-9]+)(,(\s+)?[0-9\.]+)\)/g,"rgb($1$3$5)")),o.width(parseInt(x+q))):o.width(x))}var v=o.data("reset-alpha")||!1;v&&y.picker.find(".iris-palette-container").on("click.palette",".iris-palette",function(){y._color._alpha=1,y.active="external",y._change()})},_addInputListeners:function(l){var k=this,j=100,a=function(n){var m=new Color(l.val()),o=l.val();l.removeClass("iris-error"),m.error?""!==o&&l.addClass("iris-error"):m.toString()!==k._color.toString()&&("keyup"===n.type&&o.match(/^[0-9a-fA-F]{3}$/)||k._setOption("color",m.toString()))};l.on("change",a).on("keyup",k._debounce(a,j)),k.options.hide&&l.on("focus",function(){k.show()})}})}(jQuery),jQuery(document).ready(function(a){a(".color-picker").wpColorPicker()});